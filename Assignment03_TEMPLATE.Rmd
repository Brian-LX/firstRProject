---
title: "Assignment03_TEMPLATE"
author: "Xian Lai"
date: "2024-10-02"
output: html_document
---


<!-- We need to load two packages, namely â€œStat2Dataâ€ and â€œtidyverseâ€ -->

```{r}
library(tidyverse)
library(Stat2Data)
data("Hawks")

```
# 1. Visualisation

## 1. (Q1)

<!--  about visualisation using ggplot2 -->

```{r}
hawksSmall<- drop_na(select(Hawks,Age,Day,Month,Year,CaptureTime,Species,Wing,Weight,Tail))
# Check the dimensions (rows and columns) of hawksSmall
dim(hawksSmall)

# Display the first 5 rows of hawksSmall
head(hawksSmall, 5)
```
## 1. (Q2)

```{r}
# Load the ggplot2 package if not already loaded
library(ggplot2)

# Create a histogram of hawks' weights with a bin width of 10
ggplot(hawksSmall, aes(x = Weight)) +
  geom_histogram(binwidth = 10, fill = "blue", color = "black") +
  labs(title = "Histogram of Hawk Weights",
       x = "Weight",
       y = "Count") +
  theme_minimal()



```
## 1. (Q3)
```{r}
# åˆ›å»ºä¸¤ä¸ªä¸åŒ adjust å‚æ•°çš„å¯†åº¦å›¾
ggplot(hawksSmall, aes(x = Tail)) +
  geom_density(adjust = 0.5, color = "red", fill = "red", alpha = 0.3) +  # adjust = 0.5
  geom_density(adjust = 2, color = "blue", fill = "blue", alpha = 0.3) +  # adjust = 2
  labs(title = "Density map of eagle tail length",
       x = "tail lengths",
       y = "density") +
  theme_minimal()




```
## 1. (Q4)
Based on the answer from (Q3), create density plot based on 3 species.

```{r}
# Three species, CH, RT and SS, were screened
hawks_filtered <- subset(hawksSmall, Species %in% c("CH", "RT", "SS"))

# Plot tail length density based on CH, RT, and SS species
ggplot(hawks_filtered, aes(x = Tail, color = Species, fill = Species)) +
  geom_density(alpha = 0.4, adjust = 2) +  # adjust=1
  labs(title = "Tail length density of eagle in CH, RT, SS species",
       x = "tail lengths",
       y = "density") +
  theme_minimal()


```

## 1. (Q5) Violin plot:
<!--  Use the ggplot and geom_violin() functions to create the following violin plot for the three species. -->
```{r}
ggplot(hawks_filtered, aes(x = Tail, y = Species, fill = Species)) +
  geom_violin(trim = TRUE, adjust = 1) +  # Use the violin diagram with clipping the tail
  labs(title = "Violin diagram of tail length of different species of eagle",
       x = "Species (mm)",
       y = "Tail Lengths") +
  theme_minimal()

```
## 1. (Q6) Scatter plot
<!-- Generate a plot similar to the following plot using the ggplot() and geom_point() functions.
1. How many aesthetics are present within the following plot?
2. What are the glyphs within this plot?
3. What are the visual cues being used within this plot
-->
```{r}
# Create a scatter plot using geom_point()
ggplot(hawks_filtered, aes(x = Tail, y = Weight, color = Species, shape=Species)) +
  geom_point(position = position_jitter(width = 0.2), size = 3) +
  labs(title = "Scatter plot of tail length of different species of eagle",
       x = "Species",
       y = "Tail Lengths") +
  theme_minimal()
```
## 1. (Q7) Trend lines and facet wraps:
<!-- Generate the following plot using the ggplot(), geom_point(), geom_smooth() and 
facet_wrap() functions. Note that in the facet plot, the three panels use different 
scales. 
1. What are the visual cues being used within this plot?
2. Based on the plot below, what can we say about the relationship between the weight of the hawks and their tail lengths?
-->

```{r}
ggplot(hawks_filtered, aes(x = Tail, y = Weight, color = Species)) + 
  geom_point(size = 2, position = position_jitter(width = 0.2)) +  # æ•£ç‚¹
  geom_smooth(method = "lm", se = FALSE) +  # æ·»åŠ çº¿æ€§å›å½’çº¿
  facet_wrap(~ Species) +  # æŒ‰ç‰©ç§åˆ†é¢ï¼Œä½¿ç”¨ä¸åŒçš„åæ ‡è½´æ¯”ä¾‹
  labs(title = "Relationship between tail length and weight in 3 species",
       x = "Tail (mm)", 
       y = "Weight") +
  theme_minimal() +
  theme(strip.background = element_rect(fill = "lightgray")) 



```
## 1. (Q8) Adding annotations
<!-- First, compute the â€œWeightâ€ and the â€œTailâ€ of the heaviest hawk in the dataset. You 
can use filter() and select() function to select proper data. 
Second, reuse the code that you create from Q(3), adding an arrow and an 
annotation to indicate the heaviest hawk. Your result should look similar to this.
-->
```{r}
library(dplyr)

# æ‰¾åˆ°æœ€é‡çš„é¹°ï¼Œå¹¶æå– Weight å’Œ Tail åˆ—
heaviest_hawk <- hawksSmall %>%
  filter(Weight == max(Weight)) %>%  # æ‰¾åˆ°æœ€å¤§ä½“é‡çš„é¹°
  select(Weight, Tail)  # é€‰æ‹© Weight å’Œ Tail åˆ—

# æŸ¥çœ‹ç»“æœ
print(heaviest_hawk)


```
```{r}
# æ‰¾åˆ°æœ€é‡çš„é¹°
heaviest_hawk <- hawks_filtered %>%
  filter(Weight == max(Weight))  # ç­›é€‰å‡ºæœ€é‡çš„é¹°

# åˆ›å»ºæ•£ç‚¹å›¾
ggplot(hawks_filtered, aes(x = Tail, y = Weight, color = Species, shape = Species)) +
  geom_point(position = position_jitter(width = 0.2), size = 3) +
  labs(title = "Tail lengths of different species",
       x = "Tail",
       y = "Weight") +
  theme_minimal() +
  # æ·»åŠ ç®­å¤´æŒ‡å‘æœ€é‡çš„é¹°
  geom_segment(aes(x = heaviest_hawk$Tail, y = heaviest_hawk$Weight,
                   xend = heaviest_hawk$Tail + 5, yend = heaviest_hawk$Weight + 5), 
               arrow = arrow(length = unit(0.1, "inches")), 
               color = "red", size = 1) +
  # æ·»åŠ æ³¨é‡Š
  annotate("text", x = heaviest_hawk$Tail + 5, y = heaviest_hawk$Weight + 5,
           label = paste("Heaviest Hawk"),
           color = "red", size = 4, hjust = 0)
```
# 2. Finite probability spaces
## 2.1 Sampling with replacement
Recall that for positive integers ğ‘› and ğ‘˜, $(\frac{ğ‘›}{ğ‘˜}) =\frac{ğ‘›!}{ğ‘˜!(ğ‘›âˆ’ğ‘˜)!}$ gives the number of subsets of size ğ‘˜ from a set of ğ‘› objects.
You can compute this number straightforwardly within â€œRâ€ via the choose function â€œchoose()â€

```{r}
# è®¡ç®—ä» 8 ä¸ªå¯¹è±¡ä¸­é€‰æ‹© 3 ä¸ªå¯¹è±¡çš„ç»„åˆæ•°
n <- 8  # é›†åˆå¤§å°
k <- 3  # å­é›†å¤§å°

# ä½¿ç”¨ choose å‡½æ•°è®¡ç®—ç»„åˆæ•°
num_combinations <- choose(n, k)

# æ‰“å°ç»“æœ
print(num_combinations)
```
### (Q1) 
<!-- Write down a mathematical expression for the probability that ğ‘§ out of the 22
selections were red spheres (here ğ‘§ âˆˆ {0,1, â‹¯ ,22}).-->
<!-- You can try writing down your mathematical expression using â€œLaTexâ€ code in your 
R markdown file, making use of the LaTex functions â€œbinom{â€{}} and â€œfrac{â€{}}. For 
information about writing mathematical formulae in Rmarkdown documents, find 
illustrative examples in â€œAssignment_R MarkdownMathformulasandSymbolsExamples.rmdâ€--> 


